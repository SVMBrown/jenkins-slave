language: generic
sudo: required
services:
- docker
env:
  global:
  - COMMIT=${TRAVIS_COMMIT::1}
  - REPO=haraldkoch/jenkins-slave
  - secure: wOCaL3zGa0Upn6GMAh5iFtrsv01gwAbJJyC4mLnM5fNuCcxJAtWndPIfuRkckTL4ArcCqWPWdayJWVoc3clTL4cVGwwi47F0tuBTZIM++duoubmVStkSsUgK5cQifWIqz96DQYjB+KBwTLcwqVH5MF8lisUseAl8Y/kcFWAlUKosCTAxEEN/lUYyGrXcG23sWvI41hU4alkKHAYcz+2Gvr4L1O80jRejeRsXlC+0sR4MpdWkrQfcjKj7rqfEmGdnWijLXqHgW3aGh0qrBSGQDqoD9vu2obZTpePqfEY0LcgsSF84RwAQl+8IJsnWxn6qcy1hoNuK8eUzRDSvzuauP9nq80euKb0XXtTO6zcziXfOiLVqa4ntRbzaqI/hyaOABCorKniP9XsaywESMKtIn+44OIWQdozJYuAFruXf5GcB0V98MXyB3JqtTxekNd80UWirGJ00LwWK5wk2IfuOKGgHUBe1rzcZ1iB9vj1c1KIBa9Ci6XEfe6QUCjfFU7EpVoI7azxyVS+ZiQyZgfjgI8R8oqp0q+ZFn/2g18ahwYU7K29Ox0hHkyv8i63X+KTP/9oIOSXplkyA+SB+4lw30nh2xGzKIaRiY6CUr4AQAToND0sb1QbCp/EMa2nPyuCbib/IGWPodVTKYcTI+yaKlVhzPVS8II9+2nS4J7BpLqs=
  - secure: ZWy5nKSb8tMCTBm1dDeNFGkuUjZrD5X2q9VKxjwlMoIlTEReksEl0pnSJmL/R9SJWdsd8YGIuXONU4K8lypw2jp3pTTq8q2AliaITI3ERlGLkqygyCBVd4SMn61k0yTpKlPT/39PLh64KIrKvQjmRhr0ba41q15MmSFcQNhhTuofElk4JBZfqj7PFtkinCniKC0wpayjrt7yHbtzn3ai1CxGsgMYuf2FmJg8KEoDBthjy9rkZwhDAxVZEZvYdFtpWqMPi7lnJKvdDYoWICtqC0wp+7XVqeVKjtyN5pwjBcdHKMfgQmdfjwCm4oz7wKhQfY21ruOcynHcJTrX8IMHqEWMBOdq38BY6SSNXkcvBgeK/+YLgtx0TJ4hNnf9V26OFYVq0dISVQLE/pePS7fH+cyu7JA0yEpLbh5Izl0ExBHKEb4tFwiT1h372RUH7w3H49UbJahhfo6VyIJ84VUyxiW5V/ohKaHP4s4jQ82bO1n3HqzZCIS8ssvJT7Cfp4gmSp/D914ydJcx6CEyrgEbr28DyvKLnpuNUn+JfyYt9iGEZwcSvJYR0fDChWsBFmMS0Ou1PWJvSVnpXM0c4YNedlRGPvKT0HTXp/V3HqZhPJd0y3SdPGmWGNMcloN+knc0AXWIRCPwk/dAx/efV88xT1fF4iHTvOmq45NiYxE8UFY=
  - secure: LV2q99VOfAhKJHEi6/6OmqTI0oT1A77uWdstyT0DGh8afxXjJhUK0lL/YSSM665UwxX6axnRE2VEn3q0lq+2Sk/04va6SS9zeHbZrDedAs5zv3gJwmAtIC7kcnq3Txsm0/I00zOcASBdI4xcZgfNEAt6n2+bREqp0rAxs6Z9/jrdoWkUzlTcbLIc290f3BSTy3q9nkuRzNQNWDrsHA8AjTGJRTGM72nhEm23WJ1spMPU0JWnYHlf5mjrTUy1i8P81SNizBKArQi31V8RT7kaL7PoP7IcUaHh7d0PWEx31jX/0PfeNidISGt5sFjKD1670blLqRjddRWwaG4ryil02wTkOlWs7otRDdJxHHU+Pe8GnFEYz+nHM3AyrCUYJFajb9JKwfRjPvXj+3UHRmGi9gMQ/p2dr5j13ItdoXnnoRPjdCsPH2pBlRg3unEDjQFHNbdEFl0AETNPryykmGsHSeR6GoRlZOporaWeoc1jUJaGQRScDPfNrTRDg5Rob4EliKbjyh0qZj1DwXbJDNMV75vzrEh/RqeyC1reRg4au7gPJFmNwFNmqcnU15NnA5tcTnBo80wqHUq+41GBSD7w+XmaLm9lBtG8ao9Z98CVKe3hGNeqv4jr1zbt2rhCEsdjr25JG9pkTY1ed5LsNG05hVq1Q0FiSGUS7lNvRjSWchk=
script: docker build -f Docketfile -t $REPO:$COMMIT .
after_success:
- docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
- export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH;
  fi`
- docker tag $REPO:$COMMIT $REPO:$TAG
- docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER
- docker push $REPO
